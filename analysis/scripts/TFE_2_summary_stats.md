Summary statistics - tool function experiment
================
Lisa Schunk
2020-09-03 09:41:15

  - [Goal of the script](#goal-of-the-script)
  - [Load packages](#load-packages)
  - [Get names, path and information of the
    file](#get-names-path-and-information-of-the-file)
  - [Load data into R object](#load-data-into-r-object)
  - [4. Define numeric variables](#define-numeric-variables)
  - [Compute summary statistics](#compute-summary-statistics)
      - [Create function to compute the statistics at
        once](#create-function-to-compute-the-statistics-at-once)
      - [Compute the summary statistics in
        groups](#compute-the-summary-statistics-in-groups)
          - [Spots](#spots)
          - [Task and edge angel](#task-and-edge-angel)
          - [Raw material](#raw-material)
  - [Save data](#save-data)
      - [Format name of output file](#format-name-of-output-file)
      - [Write to XLSX](#write-to-xlsx)
      - [Save R object](#save-r-object)
      - [Show file information](#show-file-information)
  - [sessionInfo() and RStudio
    version](#sessioninfo-and-rstudio-version)

-----

# Goal of the script

This script computes standard descriptive statistics for each group.  
The groups are based on:

  - Raw material
  - Spots (replicas)
  - Task + edge anlge

It computes the following statistics:

  - n (sample size = `length`): number of measurements  
  - smallest value (`min`)  
  - largest value (`max`)
  - mean  
  - median  
  - standard deviation (`sd`)

<!-- end list -->

``` r
dir_in <- "analysis/derived_data/"
dir_out <- "analysis/summary_stats/"
```

Raw data must be located in \~/analysis/derived\_data/.  
Formatted data will be saved in \~/analysis/summary\_stats/. The knit
directory for this script is the project directory.

-----

# Load packages

``` r
library(openxlsx)
library(R.utils)
library(tools)
library(doBy)
```

-----

# Get names, path and information of the file

``` r
data_file <- list.files(dir_in, pattern = "\\.xlsx$", full.names = TRUE)
md5_in <- md5sum(data_file)
info_in <- data.frame(file = basename(names(md5_in)), checksum = md5_in, row.names = NULL)
```

The checksum (MD5 hashes) of the imported file is

``` 
               file                         checksum
1 TFE_use-wear.xlsx 4a7aed88b12199e5d33e05ad967d4d26
```

# Load data into R object

``` r
imp_data <- loadObject(paste0(dir_in, "TFE_use-wear.Rbin"))
```

The imported file is: “\~/analysis/derived\_data/TFE\_use-wear.xlsx”

-----

# 4\. Define numeric variables

``` r
num.var <- 24:length(imp_data)
```

The following variables will be used:

    [24] Sq
    [25] Ssk
    [26] Sku
    [27] Sp
    [28] Sv
    [29] Sz
    [30] Sa
    [31] Smr
    [32] Smc
    [33] Sxp
    [34] Sal
    [35] Str
    [36] Std
    [37] Sdq
    [38] Sdr
    [39] Vm
    [40] Vv
    [41] Vmp
    [42] Vmc
    [43] Vvc
    [44] Vvv
    [45] Maximum.depth.of.furrows
    [46] Mean.depth.of.furrows
    [47] Mean.density.of.furrows
    [48] First.direction
    [49] Second.direction
    [50] Third.direction
    [51] Isotropy
    [52] epLsar
    [53] NewEplsar
    [54] Asfc
    [55] Smfc
    [56] HAsfc9
    [57] HAsfc81

-----

# Compute summary statistics

## Create function to compute the statistics at once

``` r
nminmaxmeanmedsd <- function(x){
    y <- x[!is.na(x)]
    n_test <- length(y)
    min_test <- min(y)
    max_test <- max(y)
    mean_test <- mean(y)
    med_test <- median(y)
    sd_test <- sd(y)
    out <- c(n_test, min_test, max_test, mean_test, med_test, sd_test)
    names(out) <- c("n", "min", "max", "mean", "median", "sd")
    return(out)
}
```

## Compute the summary statistics in groups

### Spots

``` r
spot <- summaryBy(.~Sample+Location+Area, 
                  data=imp_data[c("Sample","Location","Area" ,names(imp_data)[num.var])], 
                  FUN=nminmaxmeanmedsd)
str(spot)
```

    'data.frame':   8 obs. of  207 variables:
     $ Sample                         : chr  "FLT8-10" "FLT8-2" "FLT8-5" "FLT8-9" ...
     $ Location                       : chr  "C1" "D1" "C1" "B1" ...
     $ Area                           : chr  "01" "01" "01" "01" ...
     $ Sq.n                           : num  3 3 3 3 3 3 3 3
     $ Sq.min                         : num  315 1718 196 153 231 ...
     $ Sq.max                         : num  7217 2546 226 13075 433 ...
     $ Sq.mean                        : num  3057 2263 215 4465 323 ...
     $ Sq.median                      : num  1640 2525 223 167 306 ...
     $ Sq.sd                          : num  3662.7 471.9 16.6 7456.4 102.1 ...
     $ Ssk.n                          : num  3 3 3 3 3 3 3 3
     $ Ssk.min                        : num  -1.202 -1.432 -3.721 -0.315 -3.03 ...
     $ Ssk.max                        : num  0.517 -0.51 -0.791 3.156 2.896 ...
     $ Ssk.mean                       : num  -0.437 -0.905 -2.155 1.664 -0.595 ...
     $ Ssk.median                     : num  -0.626 -0.772 -1.953 2.152 -1.65 ...
     $ Ssk.sd                         : num  0.875 0.475 1.475 1.786 3.1 ...
     $ Sku.n                          : num  3 3 3 3 3 3 3 3
     $ Sku.min                        : num  4.34 6.94 4.74 4.58 18.08 ...
     $ Sku.max                        : num  7.12 12.01 27.61 31.11 32.75 ...
     $ Sku.mean                       : num  5.93 9.19 14.2 18.52 23.4 ...
     $ Sku.median                     : num  6.34 8.62 10.24 19.86 19.36 ...
     $ Sku.sd                         : num  1.43 2.58 11.94 13.31 8.13 ...
     $ Sp.n                           : num  3 3 3 3 3 3 3 3
     $ Sp.min                         : num  716 5842 525 1458 1712 ...
     $ Sp.max                         : num  24832 8900 620 26706 3221 ...
     $ Sp.mean                        : num  10384 7802 572 9910 2217 ...
     $ Sp.median                      : num  5603 8665 570 1565 1717 ...
     $ Sp.sd                          : num  12749.4 1702 47.6 14546.2 870 ...
     $ Sv.n                           : num  3 3 3 3 3 3 3 3
     $ Sv.min                         : num  1929 11581 1068 768 1264 ...
     $ Sv.max                         : num  24749 14246 2162 99093 3612 ...
     $ Sv.mean                        : num  11344 12928 1552 33611 2400 ...
     $ Sv.median                      : num  7354 12958 1426 971 2322 ...
     $ Sv.sd                          : num  11922 1332 557 56710 1176 ...
     $ Sz.n                           : num  3 3 3 3 3 3 3 3
     $ Sz.min                         : num  2645 17423 1688 2333 4034 ...
     $ Sz.max                         : num  49581 22911 2686 125800 5329 ...
     $ Sz.mean                        : num  21727 20731 2124 43521 4616 ...
     $ Sz.median                      : num  12956 21858 1996 2429 4486 ...
     $ Sz.sd                          : num  24667 2912 511 71256 657 ...
     $ Sa.n                           : num  3 3 3 3 3 3 3 3
     $ Sa.min                         : num  238.6 1117.1 138.7 85.2 157 ...
     $ Sa.max                         : num  5359 1814 166 10906 266 ...
     $ Sa.mean                        : num  2226 1567 148 3695 203 ...
     $ Sa.median                      : num  1080.4 1769.3 139.3 93.9 184.6 ...
     $ Sa.sd                          : num  2745.8 390.1 15.4 6244.7 56.6 ...
     $ Smr.n                          : num  3 3 3 3 3 3 3 3
     $ Smr.min                        : num  0.151 0.41 94.062 0.296 0.345 ...
     $ Smr.max                        : num  84.156 0.768 97.359 1.943 0.77 ...
     $ Smr.mean                       : num  28.398 0.566 96.055 1.109 0.493 ...
     $ Smr.median                     : num  0.887 0.519 96.743 1.088 0.365 ...
     $ Smr.sd                         : num  48.289 0.183 1.753 0.824 0.24 ...
     $ Smc.n                          : num  3 3 3 3 3 3 3 3
     $ Smc.min                        : num  349.5 1633.5 191.7 95.7 199 ...
     $ Smc.max                        : num  8453 2737 248 18265 335 ...
     $ Smc.mean                       : num  3491 2330 211 6154 252 ...
     $ Smc.median                     : num  1669 2619.7 194.4 99.7 223.2 ...
     $ Smc.sd                         : num  4348.2 606 31.9 10489 72.5 ...
     $ Sxp.n                          : num  3 3 3 3 3 3 3 3
     $ Sxp.min                        : num  770 3974 526 280 561 ...
     $ Sxp.max                        : num  13827 5202 576 18794 1190 ...
     $ Sxp.mean                       : num  6350 4675 544 6460 796 ...
     $ Sxp.median                     : num  4454 4849 530 305 637 ...
     $ Sxp.sd                         : num  6732 632 28 10682 343 ...
     $ Sal.n                          : num  3 3 3 3 3 3 3 3
     $ Sal.min                        : num  11.35 17.69 9.98 9.34 6.8 ...
     $ Sal.max                        : num  19.27 23.58 17.34 46.79 9.97 ...
     $ Sal.mean                       : num  16.32 20.46 13.43 22.24 8.58 ...
     $ Sal.median                     : num  18.33 20.11 12.98 10.58 8.96 ...
     $ Sal.sd                         : num  4.33 2.96 3.7 21.27 1.62 ...
     $ Str.n                          : num  2 2 3 2 3 3 3 3
     $ Str.min                        : num  0.26 0.154 0.222 0.689 0.139 ...
     $ Str.max                        : num  0.286 0.514 0.844 0.714 0.544 ...
     $ Str.mean                       : num  0.273 0.334 0.446 0.701 0.386 ...
     $ Str.median                     : num  0.273 0.334 0.272 0.701 0.476 ...
     $ Str.sd                         : num  0.0187 0.2547 0.3456 0.0183 0.2168 ...
     $ Std.n                          : num  3 3 3 3 3 3 3 3
     $ Std.min                        : num  156.3 140.5 151.7 25 79.3 ...
     $ Std.max                        : num  169 148.5 151.8 176.5 99.7 ...
     $ Std.mean                       : num  161.5 145.8 151.7 88.4 87 ...
     $ Std.median                     : num  159.2 148.5 151.7 63.8 82 ...
     $ Std.sd                         : num  6.66741 4.60984 0.00718 78.70957 11.12649 ...
     $ Sdq.n                          : num  3 3 3 3 3 3 3 3
     $ Sdq.min                        : num  0.1657 0.2937 0.0927 0.1005 0.1363 ...
     $ Sdq.max                        : num  1.165 0.35 0.102 1.551 0.198 ...
     $ Sdq.mean                       : num  0.5332 0.3264 0.0979 0.5869 0.1611 ...
     $ Sdq.median                     : num  0.269 0.3357 0.0994 0.109 0.1493 ...
     $ Sdq.sd                         : num  0.54942 0.02926 0.00469 0.83509 0.03229 ...
     $ Sdr.n                          : num  3 3 3 3 3 3 3 3
     $ Sdr.min                        : num  1.348 3.608 0.421 0.495 0.906 ...
     $ Sdr.max                        : num  19.198 4.76 0.511 27.267 1.829 ...
     $ Sdr.mean                       : num  7.851 4.33 0.474 9.446 1.264 ...
     $ Sdr.median                     : num  3.006 4.623 0.489 0.578 1.057 ...
     $ Sdr.sd                         : num  9.862 0.6294 0.0472 15.4327 0.4948 ...
     $ Vm.n                           : num  3 3 3 3 3 3 3 3
     $ Vm.min                         : num  0.0093 0.11486 0.00505 0.01399 0.00937 ...
     $ Vm.max                         : num  0.67139 0.18403 0.00995 0.29933 0.02147 ...
     $ Vm.mean                        : num  0.27203 0.16026 0.00697 0.11089 0.01434 ...
     $ Vm.median                      : num  0.1354 0.1819 0.0059 0.0193 0.0122 ...
     $ Vm.sd                          : num  0.35156 0.03933 0.00262 0.16322 0.00634 ...
      [list output truncated]

### Task and edge angel

``` r
task <- summaryBy(.~Sample+Task+Edge.angle, 
                  data=imp_data[c("Sample", "Task", "Edge.angle",names(imp_data)[num.var])], 
                  FUN=nminmaxmeanmedsd)
str(task)
```

    'data.frame':   8 obs. of  207 variables:
     $ Sample                         : chr  "FLT8-10" "FLT8-2" "FLT8-5" "FLT8-9" ...
     $ Task                           : Factor w/ 2 levels "carving","cutting": 1 2 2 1 1 2 2 1
     $ Edge.angle                     : Factor w/ 2 levels "35°","45°": 2 2 1 1 1 2 1 2
     $ Sq.n                           : num  3 3 3 3 3 3 3 3
     $ Sq.min                         : num  315 1718 196 153 231 ...
     $ Sq.max                         : num  7217 2546 226 13075 433 ...
     $ Sq.mean                        : num  3057 2263 215 4465 323 ...
     $ Sq.median                      : num  1640 2525 223 167 306 ...
     $ Sq.sd                          : num  3662.7 471.9 16.6 7456.4 102.1 ...
     $ Ssk.n                          : num  3 3 3 3 3 3 3 3
     $ Ssk.min                        : num  -1.202 -1.432 -3.721 -0.315 -3.03 ...
     $ Ssk.max                        : num  0.517 -0.51 -0.791 3.156 2.896 ...
     $ Ssk.mean                       : num  -0.437 -0.905 -2.155 1.664 -0.595 ...
     $ Ssk.median                     : num  -0.626 -0.772 -1.953 2.152 -1.65 ...
     $ Ssk.sd                         : num  0.875 0.475 1.475 1.786 3.1 ...
     $ Sku.n                          : num  3 3 3 3 3 3 3 3
     $ Sku.min                        : num  4.34 6.94 4.74 4.58 18.08 ...
     $ Sku.max                        : num  7.12 12.01 27.61 31.11 32.75 ...
     $ Sku.mean                       : num  5.93 9.19 14.2 18.52 23.4 ...
     $ Sku.median                     : num  6.34 8.62 10.24 19.86 19.36 ...
     $ Sku.sd                         : num  1.43 2.58 11.94 13.31 8.13 ...
     $ Sp.n                           : num  3 3 3 3 3 3 3 3
     $ Sp.min                         : num  716 5842 525 1458 1712 ...
     $ Sp.max                         : num  24832 8900 620 26706 3221 ...
     $ Sp.mean                        : num  10384 7802 572 9910 2217 ...
     $ Sp.median                      : num  5603 8665 570 1565 1717 ...
     $ Sp.sd                          : num  12749.4 1702 47.6 14546.2 870 ...
     $ Sv.n                           : num  3 3 3 3 3 3 3 3
     $ Sv.min                         : num  1929 11581 1068 768 1264 ...
     $ Sv.max                         : num  24749 14246 2162 99093 3612 ...
     $ Sv.mean                        : num  11344 12928 1552 33611 2400 ...
     $ Sv.median                      : num  7354 12958 1426 971 2322 ...
     $ Sv.sd                          : num  11922 1332 557 56710 1176 ...
     $ Sz.n                           : num  3 3 3 3 3 3 3 3
     $ Sz.min                         : num  2645 17423 1688 2333 4034 ...
     $ Sz.max                         : num  49581 22911 2686 125800 5329 ...
     $ Sz.mean                        : num  21727 20731 2124 43521 4616 ...
     $ Sz.median                      : num  12956 21858 1996 2429 4486 ...
     $ Sz.sd                          : num  24667 2912 511 71256 657 ...
     $ Sa.n                           : num  3 3 3 3 3 3 3 3
     $ Sa.min                         : num  238.6 1117.1 138.7 85.2 157 ...
     $ Sa.max                         : num  5359 1814 166 10906 266 ...
     $ Sa.mean                        : num  2226 1567 148 3695 203 ...
     $ Sa.median                      : num  1080.4 1769.3 139.3 93.9 184.6 ...
     $ Sa.sd                          : num  2745.8 390.1 15.4 6244.7 56.6 ...
     $ Smr.n                          : num  3 3 3 3 3 3 3 3
     $ Smr.min                        : num  0.151 0.41 94.062 0.296 0.345 ...
     $ Smr.max                        : num  84.156 0.768 97.359 1.943 0.77 ...
     $ Smr.mean                       : num  28.398 0.566 96.055 1.109 0.493 ...
     $ Smr.median                     : num  0.887 0.519 96.743 1.088 0.365 ...
     $ Smr.sd                         : num  48.289 0.183 1.753 0.824 0.24 ...
     $ Smc.n                          : num  3 3 3 3 3 3 3 3
     $ Smc.min                        : num  349.5 1633.5 191.7 95.7 199 ...
     $ Smc.max                        : num  8453 2737 248 18265 335 ...
     $ Smc.mean                       : num  3491 2330 211 6154 252 ...
     $ Smc.median                     : num  1669 2619.7 194.4 99.7 223.2 ...
     $ Smc.sd                         : num  4348.2 606 31.9 10489 72.5 ...
     $ Sxp.n                          : num  3 3 3 3 3 3 3 3
     $ Sxp.min                        : num  770 3974 526 280 561 ...
     $ Sxp.max                        : num  13827 5202 576 18794 1190 ...
     $ Sxp.mean                       : num  6350 4675 544 6460 796 ...
     $ Sxp.median                     : num  4454 4849 530 305 637 ...
     $ Sxp.sd                         : num  6732 632 28 10682 343 ...
     $ Sal.n                          : num  3 3 3 3 3 3 3 3
     $ Sal.min                        : num  11.35 17.69 9.98 9.34 6.8 ...
     $ Sal.max                        : num  19.27 23.58 17.34 46.79 9.97 ...
     $ Sal.mean                       : num  16.32 20.46 13.43 22.24 8.58 ...
     $ Sal.median                     : num  18.33 20.11 12.98 10.58 8.96 ...
     $ Sal.sd                         : num  4.33 2.96 3.7 21.27 1.62 ...
     $ Str.n                          : num  2 2 3 2 3 3 3 3
     $ Str.min                        : num  0.26 0.154 0.222 0.689 0.139 ...
     $ Str.max                        : num  0.286 0.514 0.844 0.714 0.544 ...
     $ Str.mean                       : num  0.273 0.334 0.446 0.701 0.386 ...
     $ Str.median                     : num  0.273 0.334 0.272 0.701 0.476 ...
     $ Str.sd                         : num  0.0187 0.2547 0.3456 0.0183 0.2168 ...
     $ Std.n                          : num  3 3 3 3 3 3 3 3
     $ Std.min                        : num  156.3 140.5 151.7 25 79.3 ...
     $ Std.max                        : num  169 148.5 151.8 176.5 99.7 ...
     $ Std.mean                       : num  161.5 145.8 151.7 88.4 87 ...
     $ Std.median                     : num  159.2 148.5 151.7 63.8 82 ...
     $ Std.sd                         : num  6.66741 4.60984 0.00718 78.70957 11.12649 ...
     $ Sdq.n                          : num  3 3 3 3 3 3 3 3
     $ Sdq.min                        : num  0.1657 0.2937 0.0927 0.1005 0.1363 ...
     $ Sdq.max                        : num  1.165 0.35 0.102 1.551 0.198 ...
     $ Sdq.mean                       : num  0.5332 0.3264 0.0979 0.5869 0.1611 ...
     $ Sdq.median                     : num  0.269 0.3357 0.0994 0.109 0.1493 ...
     $ Sdq.sd                         : num  0.54942 0.02926 0.00469 0.83509 0.03229 ...
     $ Sdr.n                          : num  3 3 3 3 3 3 3 3
     $ Sdr.min                        : num  1.348 3.608 0.421 0.495 0.906 ...
     $ Sdr.max                        : num  19.198 4.76 0.511 27.267 1.829 ...
     $ Sdr.mean                       : num  7.851 4.33 0.474 9.446 1.264 ...
     $ Sdr.median                     : num  3.006 4.623 0.489 0.578 1.057 ...
     $ Sdr.sd                         : num  9.862 0.6294 0.0472 15.4327 0.4948 ...
     $ Vm.n                           : num  3 3 3 3 3 3 3 3
     $ Vm.min                         : num  0.0093 0.11486 0.00505 0.01399 0.00937 ...
     $ Vm.max                         : num  0.67139 0.18403 0.00995 0.29933 0.02147 ...
     $ Vm.mean                        : num  0.27203 0.16026 0.00697 0.11089 0.01434 ...
     $ Vm.median                      : num  0.1354 0.1819 0.0059 0.0193 0.0122 ...
     $ Vm.sd                          : num  0.35156 0.03933 0.00262 0.16322 0.00634 ...
      [list output truncated]

### Raw material

``` r
raw_material <- summaryBy(.~Raw.material+Task+Edge.angle, 
                          data=imp_data[c("Raw.material","Task","Edge.angle",
                                          names(imp_data)[num.var])], FUN=nminmaxmeanmedsd)
str(raw_material)
```

    'data.frame':   8 obs. of  207 variables:
     $ Raw.material                   : Factor w/ 2 levels "flint","lydite": 1 1 1 1 2 2 2 2
     $ Task                           : Factor w/ 2 levels "carving","cutting": 1 1 2 2 1 1 2 2
     $ Edge.angle                     : Factor w/ 2 levels "35°","45°": 1 2 1 2 1 2 1 2
     $ Sq.n                           : num  3 3 3 3 3 3 3 3
     $ Sq.min                         : num  153 315 196 1718 231 ...
     $ Sq.max                         : num  13075 7217 226 2546 433 ...
     $ Sq.mean                        : num  4465 3057 215 2263 323 ...
     $ Sq.median                      : num  167 1640 223 2525 306 ...
     $ Sq.sd                          : num  7456.4 3662.7 16.6 471.9 102.1 ...
     $ Ssk.n                          : num  3 3 3 3 3 3 3 3
     $ Ssk.min                        : num  -0.315 -1.202 -3.721 -1.432 -3.03 ...
     $ Ssk.max                        : num  3.156 0.517 -0.791 -0.51 2.896 ...
     $ Ssk.mean                       : num  1.664 -0.437 -2.155 -0.905 -0.595 ...
     $ Ssk.median                     : num  2.152 -0.626 -1.953 -0.772 -1.65 ...
     $ Ssk.sd                         : num  1.786 0.875 1.475 0.475 3.1 ...
     $ Sku.n                          : num  3 3 3 3 3 3 3 3
     $ Sku.min                        : num  4.58 4.34 4.74 6.94 18.08 ...
     $ Sku.max                        : num  31.11 7.12 27.61 12.01 32.75 ...
     $ Sku.mean                       : num  18.52 5.93 14.2 9.19 23.4 ...
     $ Sku.median                     : num  19.86 6.34 10.24 8.62 19.36 ...
     $ Sku.sd                         : num  13.31 1.43 11.94 2.58 8.13 ...
     $ Sp.n                           : num  3 3 3 3 3 3 3 3
     $ Sp.min                         : num  1458 716 525 5842 1712 ...
     $ Sp.max                         : num  26706 24832 620 8900 3221 ...
     $ Sp.mean                        : num  9910 10384 572 7802 2217 ...
     $ Sp.median                      : num  1565 5603 570 8665 1717 ...
     $ Sp.sd                          : num  14546.2 12749.4 47.6 1702 870 ...
     $ Sv.n                           : num  3 3 3 3 3 3 3 3
     $ Sv.min                         : num  768 1929 1068 11581 1264 ...
     $ Sv.max                         : num  99093 24749 2162 14246 3612 ...
     $ Sv.mean                        : num  33611 11344 1552 12928 2400 ...
     $ Sv.median                      : num  971 7354 1426 12958 2322 ...
     $ Sv.sd                          : num  56710 11922 557 1332 1176 ...
     $ Sz.n                           : num  3 3 3 3 3 3 3 3
     $ Sz.min                         : num  2333 2645 1688 17423 4034 ...
     $ Sz.max                         : num  125800 49581 2686 22911 5329 ...
     $ Sz.mean                        : num  43521 21727 2124 20731 4616 ...
     $ Sz.median                      : num  2429 12956 1996 21858 4486 ...
     $ Sz.sd                          : num  71256 24667 511 2912 657 ...
     $ Sa.n                           : num  3 3 3 3 3 3 3 3
     $ Sa.min                         : num  85.2 238.6 138.7 1117.1 157 ...
     $ Sa.max                         : num  10906 5359 166 1814 266 ...
     $ Sa.mean                        : num  3695 2226 148 1567 203 ...
     $ Sa.median                      : num  93.9 1080.4 139.3 1769.3 184.6 ...
     $ Sa.sd                          : num  6244.7 2745.8 15.4 390.1 56.6 ...
     $ Smr.n                          : num  3 3 3 3 3 3 3 3
     $ Smr.min                        : num  0.296 0.151 94.062 0.41 0.345 ...
     $ Smr.max                        : num  1.943 84.156 97.359 0.768 0.77 ...
     $ Smr.mean                       : num  1.109 28.398 96.055 0.566 0.493 ...
     $ Smr.median                     : num  1.088 0.887 96.743 0.519 0.365 ...
     $ Smr.sd                         : num  0.824 48.289 1.753 0.183 0.24 ...
     $ Smc.n                          : num  3 3 3 3 3 3 3 3
     $ Smc.min                        : num  95.7 349.5 191.7 1633.5 199 ...
     $ Smc.max                        : num  18265 8453 248 2737 335 ...
     $ Smc.mean                       : num  6154 3491 211 2330 252 ...
     $ Smc.median                     : num  99.7 1669 194.4 2619.7 223.2 ...
     $ Smc.sd                         : num  10489 4348.2 31.9 606 72.5 ...
     $ Sxp.n                          : num  3 3 3 3 3 3 3 3
     $ Sxp.min                        : num  280 770 526 3974 561 ...
     $ Sxp.max                        : num  18794 13827 576 5202 1190 ...
     $ Sxp.mean                       : num  6460 6350 544 4675 796 ...
     $ Sxp.median                     : num  305 4454 530 4849 637 ...
     $ Sxp.sd                         : num  10682 6732 28 632 343 ...
     $ Sal.n                          : num  3 3 3 3 3 3 3 3
     $ Sal.min                        : num  9.34 11.35 9.98 17.69 6.8 ...
     $ Sal.max                        : num  46.79 19.27 17.34 23.58 9.97 ...
     $ Sal.mean                       : num  22.24 16.32 13.43 20.46 8.58 ...
     $ Sal.median                     : num  10.58 18.33 12.98 20.11 8.96 ...
     $ Sal.sd                         : num  21.27 4.33 3.7 2.96 1.62 ...
     $ Str.n                          : num  2 2 3 2 3 3 3 3
     $ Str.min                        : num  0.689 0.26 0.222 0.154 0.139 ...
     $ Str.max                        : num  0.714 0.286 0.844 0.514 0.544 ...
     $ Str.mean                       : num  0.701 0.273 0.446 0.334 0.386 ...
     $ Str.median                     : num  0.701 0.273 0.272 0.334 0.476 ...
     $ Str.sd                         : num  0.0183 0.0187 0.3456 0.2547 0.2168 ...
     $ Std.n                          : num  3 3 3 3 3 3 3 3
     $ Std.min                        : num  25 156.3 151.7 140.5 79.3 ...
     $ Std.max                        : num  176.5 169 151.8 148.5 99.7 ...
     $ Std.mean                       : num  88.4 161.5 151.7 145.8 87 ...
     $ Std.median                     : num  63.8 159.2 151.7 148.5 82 ...
     $ Std.sd                         : num  78.70957 6.66741 0.00718 4.60984 11.12649 ...
     $ Sdq.n                          : num  3 3 3 3 3 3 3 3
     $ Sdq.min                        : num  0.1005 0.1657 0.0927 0.2937 0.1363 ...
     $ Sdq.max                        : num  1.551 1.165 0.102 0.35 0.198 ...
     $ Sdq.mean                       : num  0.5869 0.5332 0.0979 0.3264 0.1611 ...
     $ Sdq.median                     : num  0.109 0.269 0.0994 0.3357 0.1493 ...
     $ Sdq.sd                         : num  0.83509 0.54942 0.00469 0.02926 0.03229 ...
     $ Sdr.n                          : num  3 3 3 3 3 3 3 3
     $ Sdr.min                        : num  0.495 1.348 0.421 3.608 0.906 ...
     $ Sdr.max                        : num  27.267 19.198 0.511 4.76 1.829 ...
     $ Sdr.mean                       : num  9.446 7.851 0.474 4.33 1.264 ...
     $ Sdr.median                     : num  0.578 3.006 0.489 4.623 1.057 ...
     $ Sdr.sd                         : num  15.4327 9.862 0.0472 0.6294 0.4948 ...
     $ Vm.n                           : num  3 3 3 3 3 3 3 3
     $ Vm.min                         : num  0.01399 0.0093 0.00505 0.11486 0.00937 ...
     $ Vm.max                         : num  0.29933 0.67139 0.00995 0.18403 0.02147 ...
     $ Vm.mean                        : num  0.11089 0.27203 0.00697 0.16026 0.01434 ...
     $ Vm.median                      : num  0.0193 0.1354 0.0059 0.1819 0.0122 ...
     $ Vm.sd                          : num  0.16322 0.35156 0.00262 0.03933 0.00634 ...
      [list output truncated]

-----

# Save data

## Format name of output file

``` r
file_out <- "TFE_stats"
```

The file will be saved as “\~/analysis/summary\_stats/.\[ext\]”.

## Write to XLSX

``` r
write.xlsx(list(spot = spot, task = task, raw_material = raw_material), 
           file = paste0(dir_out, file_out, ".xlsx"))
```

## Save R object

``` r
saveObject(list(spot=spot, task = task, raw_material = raw_material), 
           file = paste0(dir_out, file_out, ".Rbin"))
```

## Show file information

``` r
file_out <- c(paste0(dir_out, file_out, ".xlsx"), paste0(dir_out, file_out, ".Rbin"))
md5_out <- md5sum(files_out)
```

    Error in path.expand(files): Objekt 'files_out' nicht gefunden

``` r
info_out <- data.frame(files = basename(names(md5_out)), checksum = md5_out, row.names = NULL)
```

    Error in basename(names(md5_out)): Objekt 'md5_out' nicht gefunden

The checksum (MD5 hashes) of the exported files are:

    Error in eval(expr, envir, enclos): Objekt 'info_out' nicht gefunden

-----

# sessionInfo() and RStudio version

``` r
sessionInfo()
```

``` 
R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] tools     stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] doBy_4.6.7        R.utils_2.9.2     R.oo_1.23.0       R.methodsS3_1.8.0
[5] openxlsx_4.1.5   

loaded via a namespace (and not attached):
 [1] zip_2.0.4        Rcpp_1.0.4.6     compiler_4.0.2   pillar_1.4.4    
 [5] digest_0.6.25    nlme_3.1-148     lattice_0.20-41  evaluate_0.14   
 [9] lifecycle_0.2.0  tibble_3.0.1     gtable_0.3.0     pkgconfig_2.0.3 
[13] rlang_0.4.6      Matrix_1.2-18    yaml_2.2.1       xfun_0.15       
[17] dplyr_1.0.0      stringr_1.4.0    knitr_1.29       generics_0.0.2  
[21] vctrs_0.3.1      rprojroot_1.3-2  grid_4.0.2       tidyselect_1.1.0
[25] glue_1.4.1       R6_2.4.1         rmarkdown_2.3    tidyr_1.1.0     
[29] purrr_0.3.4      ggplot2_3.3.2    magrittr_1.5     backports_1.1.7 
[33] scales_1.1.1     htmltools_0.5.0  ellipsis_0.3.1   MASS_7.3-51.6   
[37] colorspace_1.4-1 Deriv_4.0.1      stringi_1.4.6    munsell_0.5.0   
[41] broom_0.5.6      crayon_1.3.4    
```

RStudio version 1.3.1073.

-----

END OF SCRIPT
